<?php
 include("../../config/settings.inc.php");

 $TITLE = "IEM Representivity";
 include("$rootpath/include/header.php");
?>
<style>
.figure {
  background: #eee;
  border: 2px dashed #000;
  text-align: center;
}
.ptext h3 {
  border-bottom: 1px solid #00f;
  padding-top: 30px;
}
.ptext h4 {
  padding-left: 45px;
  color: #f00;
}
table {
  caption-side: bottom;
}

</style>

<div class="ptext" style="width: 800px;">

<h2>IEM Representivity Analysis (<i>Draft</i>)</h2>

<h4>Daryl Herzmann and Jeff Wolt
<br />Department of Agronomy, Iowa State University</h4>

<p>The scale of representivity of a sampling network determines the area 
and time over which a measurement represents true conditions. This 
document provides information and statistics regarding the spatial
representativity of the Iowa Environmental Mesonet (IEM)
following Dubois (2000).

<ol>
 <li><a href="#introduction">Introduction</a></li>
 <li><a href="#nearest">Nearest Neighbor Index</a></li>
 <li><a href="#fractal">Fractal Dimension</a></li>
 <li><a href="#morisita">Morisita Index</a></li>
 <li><a href="#thiessen">Thiessen Polygons</a></li>
 <li><a href="#represent">Coefficient of Representativity</a></li>
 <li><a href="#conclusions">Conclusions</a></li>
</ol>

<h3><a name="introduction">1. Introduction:</a></h3>

<p>The IEM is a collection of environmental monitoring networks that have
been linked to produce a more precise analysis of weather and 
climatic variables in the state than can be achieved with any single network.
To produce higher resolution products for
the entire state, point observations are often grided onto a regular grid
using well known algorithms like nearest neighbor or a weighting function.  
This 
process is not arbitrary due to the numerous tunable parameters to most any
analysis algorithm.  It is important to investigate the characteristics of
the Iowa Environmental Mesonet to determine the appropriate scales at which we can analyze
phenomena.

<p>Each observing network in the IEM has differenting sensors, reporting times, siting, 
maintainance schedules, and quality control. Because of these differences, we
first analyze the component networks in order to evaluate their representativity.  Similiar networks in data quality are then aggregated
to explore the spatial statistical benefits of the IEM partnership.

<p>
<table cellpadding="3" cellspacing="0" border="1">
<caption>Table 1 provides an overview of the IEM networks used in this study.</caption>
<thead>
<tr><th>Abbreviation</th><th>Description</th><th>Map</th></tr>
</thead>
<tr><th>ASOS</th><td>The <a href="<?php echo $webroot; ?>/ASOS/">Iowa Automated Surface Observing System</a> sites are located at primary airports and are maintained by the National Weather Service.  This network is rigorously checked and maintained.  For Iowa, a limitation of the ASOS network is the lack of sites 
located in Westcentral and Southwest Iowa.</td><td><img src="nni_images/asos_locs.png"></tr>

<tr><th>AWOS</th><td>The <a href="<?php echo $webroot; ?>/AWOS/">Iowa Automated Weather Observing System</a> sites are located at secondary airports and are maintained by the Iowa State Department of Transportation via 3rd party contractor.  Data quality should be comparable with the ASOS network, but a number of factors produce biases when compared with the ASOS network.  The main issues include siting, maintainance schedules, network communication, and instrumentation.  Most of the big differences between the ASOS and AWOS network show up in the temperature and dew point measurements. </td><td><img src="nni_images/awos_locs.png"></tr>

<tr><th>RWIS</th><td>The <a href="<?php echo $webroot; ?>/RWIS/">Iowa Roadway Weather Information System</a> sites are located along side interstates and highways.  They are maintained by the Iowa Department of Transportation via a 3rd party contractor.  Atmospheric data from this network is of lesser quality than the ASOS or AWOS networks.  The primary purpose of the RWIS network is for automated observation of winter weather. </td><td><img src="nni_images/rwis_locs.png"></td></tr>

<tr><th>SchoolNet</th><td>The IEM collects data from a number of <a href="<?php echo $webroot; ?>/schoolnet/">SchoolNets</a>.  For the purposes of this document, we only consider the KCCI-TV SchoolNet.  Data quality is close to that of the RWIS network, but siting issues make measurements like wind and precipitation problematic. </td><td><img src="nni_images/snet_locs.png"></td></tr>

<tr><th>ISUAG</th><td>The <a href="<?php echo $webroot; ?>/agclimate/">ISU Ag Climate</a> sites primarily provide soil temperature and solar radiation readings.They are maintained by the Iowa State University Extension.  The main issue with this network is the timing of observations received.  Each station is called daily to download its observation record from the previous day. </td><td><img src="nni_images/isuag_locs.png"></td></tr>
</table>

<p>

<table cellpadding="3" cellspacing="0" border="1">
<caption>Table 2 lists our proposed combination of networks based on data quality 
and reliability.</caption>
<thead>
<tr><th>Abbreviation</th><th>Description</th><th>Map</th></tr>
</thead>
<tr><th>Tier 1</th><td>ASOS + AWOS:  The combination of these two networks is commonly used in the meteorological community to produce various analysis products.  Both networks are located at airports and are for the most part  well sited.</td><td><img src="nni_images/tier1_locs.png"></tr>

<tr><th>Tier 2</th><td>ASOS + AWOS + RWIS:  The RWIS network is included in this grouping, since it has the closest data quality reputation to the ASOS+AWOS networks.  </td><td><img src="nni_images/tier2_locs.png"></tr>

<tr><th>Tier 3</th><td>ASOS + AWOS + RWIS + SchoolNet + ISUAG:  All networks included.</td><td><img src="nni_images/tier3_locs.png"></tr>

</table>

<h3><a name="nearest">2. Nearest Neighbors Index (NNI)</a></h3>

<p>The NNI is a statistic comparing the mean minimum distances between sampling points to that which is expected by chance over some sampling area.

<h4>Procedure:</h4>

<p>Point shapefile coverages for each of the network groups was created.  These files were loaded into ESRI's ArcGIS 9.1.  An ArcGIS extension called <a href="http://arcscripts.esri.com/details.asp?dbid=12227"><i>Nearest Neighbor Analysis / Event-Event Distances</i></a> written by Dr M. Sawada was used to compute the NNI.

<h4>Data:</h4>
<table cellpadding=2 cellspacing=0 border=1>
<caption>Table 3:  NNI and associated statistics.</caption>
<thead>
<tr><th>Network</th><th>Sites</th><th>NNI</th><th>Z</th><th>Avg Min Distance<br />[km]</th><th>Expected Min Distance<br />[km]</th><th>Area [km^2]</th></tr>
</thead>
<tr><th>ASOS</th><td>15</td>
    <td style="background: #ff0;">1.58</td>
    <td>3.85</td>
    <td>71.9</td>
    <td>45.5</td>
    <td>97,920</td>
</tr>
<tr><th>AWOS</th><td>39</td>
 <td>1.28</td>
 <td>3.05</td>
 <td>38.1</td>
 <td>29.8</td>
 <td>120,650</td>
</tr>
<tr><th>RWIS</th><td>53</td>
 <td>1.45</td>
 <td>5.80</td>
 <td>36.6</td>
 <td>25.2</td>
 <td>120,103</td>
</tr>
<tr><th>SchoolNet</th><td>68</td>
 <td>1.45</td>
 <td>6.61</td>
 <td>20.0</td>
 <td>13.7</td>
 <td>45,841</td>
</tr>
<tr><th>ISUAG</th><td>12</td>
 <td>1.69</td>
 <td>4.08</td>
 <td>74.7</td>
 <td>44.2</td>
 <td>71,362</td>
</tr>
<tr><th>Tier 1</th><td>54</td>
 <td>1.32</td>
 <td>4.27</td>
 <td>34.2</td>
 <td>25.7</td>
 <td>127,572</td>
</tr>
<tr><th>Tier 2</th><td>107</td>
 <td style="background: #ff0;">0.95</td>
 <td>0.90</td>
 <td>17.4</td>
 <td>18.3</td>
 <td>132,272</td>
</tr>
<tr><th>Tier 3</th><td>187</td>
 <td>0.94</td>
 <td>1.51</td>
 <td>12.9</td>
 <td>13.7</td>
 <td>132,272</td>
</tr>
</table>

<p>Table 3 presents the results of the NNI computation.  Also presented are
the Z statistic, average minimum distance between two sites, expected minimum distance
based on a homogenous in space distribution of sites, and areal coverage
of each network and network group.

<h4>Analysis:</h4>

<table cellpadding=2 cellspacing=0 border=1>
<caption>Table 4: NNI interpretation</caption>
<thead>
<tr><th>NNI Value</th><th>Details</th></tr>
</thead>
<tr><td>&gt; 1</td><td>increasing values greater than 1 indicate more dispersion</td></tr>
<tr><td>= 1</td><td>indicates sampling points have a uniform distribution</td></tr>
<tr><td> &lt; 1</td><td>decreasing values less than 1 indicate more clustering</td></tr>
</table>

<p>Table 3 shows the results of the NNI computation.  The ASOS network has
 a relatively high value of 1.58 which indicates dispersion of the sampling
points.  This spread was one of the main reasons the IEM was created, since
the baseline ASOS network is poorly representative at even a 50 km scale over the state.  The NNI value of 0.95 for the combination of the AWOS and RWIS networks to the ASOS network in Tier 2 shows the benefit of the IEM collaboration.  
The Tier 2 value of 0.95 is very close to unity and indicates that the network has a nearly uniform distribution.  The addition on the SchoolNet and ISUAG 
networks into the Tier 3 has no effect on the NNI.

<p>The Z statistic is also presented in Table 3.  It gives an indication if
the observed pattern is significantly different from random.  If the value is
above 1.96 or below -1.96, we are 95% confident tat the distribution is not
randomly distributed.  Values of 0.90 and 1.51 for Tier 2 and Tier 3, 
respectively, would indicate some randomness to the distribution.  This may
be a result of the combination of networks that are physically located in 
different venues (ASOS/AWOS: airports, RWIS: rural roads, SchoolNet: Urban 
cities, and ISUAG rural farms).  

<h3><a name="fractal">3.  Fractal Dimension</a></h3>

<p>The fractal dimension (D<sub>m</sub>) is used to characterize the distribution of a 
geophysical data array (Lovejoy 1986).   An uniform distribution of 
elements on the surface of the Earth will have a fractal dimension of 2.
All other distributions should have a value between 0 and 2, with the degree
of inhomogeneity being measured by 2 - D<sub>m</sub>.

<p>The correlation dimension (D<sub>c</sub>) is often used as an approximation
to the fractal dimension since it is easier to compute.  To compute 
(D<sub>c</sub>), rings of increasing radius are formed around each member of
the observing network.  The number of stations are then counted within each
of these rings and then averaged for rings of the same radius.  The result is
an average station density at various distances.

<p>Doswell and Lasher-Trapp (1997) point out two problems with the 
computation of the correlation dimension.  The first is the problem of 
considering stations located near the edge of the observing network.  These
stations will only have a majority of their neighbors to one preferred 
direction.  Data from these stations will bias the computation.  The other
issue is the arbitrary nature of actually computing the correlation
dimension which involves computing the slope of a line comparing the
natural log of the station count versus the natural log of station density.
This slope of this line, thus the correlation dimension, is often not 
consistent throughout the range of data.  Two parts of the curve may appear
to be very linear, but their slopes will often be much different.

<h4>Procedure</h4>

<p>A python script was written to compute the needed variables for the 
correlation dimension statistic.  The spatial computations were done in 
the PostGIS database using the NAD83 UTM Zone15 North projection.

<h4>Data</h4>
<div class="figure">
<img src="nni_images/fractal.png">
<br />Figure 1: Correlation Dimension
</div>

<p>

<table cellpadding=2 cellspacing=0 border=1>
<caption>Table 5: Correlation dimension results</caption>
<thead><th>Distance</th><th>ASOS</th><th>AWOS</th><th>RWIS</th><th>SchoolNet</th><th>ISUAG</th><th>Tier 1</th><th>Tier 2</th><th>Tier 3</th></tr></thead>

<tr><td>30-100km</td><td>1.05</td><td>0.72</td><td>0.85</td><td>0.73</td><td>0.69</td><td>0.82</td><td>0.77</td><td>0.74</td></tr>

<tr><td>30-300km</td><td>2.23</td><td>1.65</td><td>1.75</td><td>1.25</td><td>1.99</td><td>1.78</td><td>1.67</td><td>1.56</td></tr>


</table>

<h4>Analysis</h4>

<p>The issues pointed out in Doswell (1997) are evident in this analysis as 
well.  The arbitrary selection of points used in the linear regression 
yield results that may not be accurate for the entire range of scales 
represented.  Ideally, values should not exceed 2 with 2 being an uniform
distribution in 2 dimensions.  In both ranges, values decrease with the 
inclusion of Tier 1, 2, and 3 collections.  The reason for this is the 
increased bias introduced by edge effects as the center of the domain becomes
more densely populated and the exterior portions of the state (namely Northeast
and southern Iowa) become comparitively less.

<h3><a name="morisita">4. Morisita Index</a></h3>

<p>The Morisita index investigates how much clustering occurs when a sampling
network is broken up into regular cells. If each cell has the same number of
observation points inside of it, then the index should indicate uniformity in
space at that scale.

<h4>Procedure:</h4>

<p>A python script was written to compute this value.  The spatial computations were
done in NAD83 UTM Zone 15N, which is a common projection for Iowa.  Figures 2 illustrates the Morisita index.  Within an area of interest there is a distribution 
number of observation points (leftside graphic).  In the case of the IEM, we
are concerned with the nodes within a network distributed across Iowa.  
The area of interest is divided up into equal sized cells; the number of cells 
with sites in them (rightside graphic) represents the Morisita index.

<div class="figure">
<table cellpadding="3" cellspacing="0" border="1">
<thead>
<tr><th>Observation Points</th><th>Divided up by 25 cells</th></tr>
</thead>
<tr><td><img src="nni_images/morisita_1.png" border="2"></td>
    <td><img src="nni_images/morisita_2.png" border="2"></td>
</tr></table>
<br />Figure 2:  Illustration of Morisita Index
</div>

<p>In this example, the Morisita index is around 13.  This is a very high
number and indicates clustering.  This procedure is itterated over
a range of grid cell sizes to arrive at a better understanding 
of how the clustering varies at different scales.

<h4>Data:</h4>
<div class="figure">
<img src="nni_images/morisita.gif">
<br />Figure 3: Morisita Index 
</div>

<h4>Analysis:</h4>

<p>For the Morisita Index, values above 1 indicate clustering at that scale.
  This chart clearly shows clustering of the Tier2 and Tier3 networks at small scales.  RWIS sites tend to be located in the same urban areas as airport sensors from the ASOS and AWOS network and this is reflected in clustering noted at 10-30 km cell sizes.

<p>It is interesting to note the clustering at 200-250 km within the SchoolNet.  This is a result of the KCCI SchoolNet being confined to Central Iowa.  When the index is computed, a large clustering occurs at that scale.

<h3><a name="thiessen">5. Thiessen/Voronoi polygons</a></h3>

<p>Thiessen polygons have been a traditional staple of the spatial statistian. Each polygon contains exactly one measurement point while having the property of
all points within the polygon being closer to this measurement point than any 
other point.  Isolated measurements will therefore have larger polygons than
clustered measurements.  Histograms of the area covered by these polygons 
provide insight into network homogenity.

<h4>Procedure:</h4>

<p>The point coverage shapefiles were loaded into ArcGIS 9.1.  The Thiessen polygon tool was then used to generate the polygons.  These polygons were then clipped by the border of Iowa within ArcGIS as well.  The resulting coverage was exported to Shapefile and then loaded into the IEM's spatial database for analysis.

<h4>Data:</h4>
<div class="figure">
<table cellspacing="0" cellpadding="3" border="1">
<thead><tr><th colspan="2">Figure 4: Tier 1</th></tr></thead>
<tr><td><img src="nni_images/tier1_areas.png"></td><td><img src="nni_images/tier1_th.png"></td></tr>
<thead><tr><th colspan="2">Figure 5: Tier 2</th></tr></thead>
<tr><td><img src="nni_images/tier2_areas.png"></td><td><img src="nni_images/tier2_th.png"></td></tr>
<thead><tr><th colspan="2">Figure 6: Tier 3</th></tr></thead>
<tr><td><img src="nni_images/tier3_areas.png"></td><td><img src="nni_images/tier3_th.png"></td></tr>
</table>
</div>

<h4>Analysis:</h4>

<p>Thiessen polygons provide a quick synopsis of how large of an area is 
represented by a single point.  Areas in a network that are undersampled can
quickly be seen.  Figure 4 shows the interesting contrast between the more
densely sampled areas of Central Iowa and along the I-380 corridor in Eastern
Iowa.  The largest polygons can be seen in Northeast and Southern Iowa.  The 
histogram for Tier 1 also nicely details the collection of smaller polygons
around 2,000 km**2 
along with a second mode of larger polygons around 5,000 km**2.  Unfortunately,
this bi-modal distribution is not greatly helped by the addition of the RWIS sensors in Tier 2.  The clustering of the RWIS sensors simply splits some of the
larger polygons, but a couple of rather large polygons in Northeastern Iowa still exist.

<p>For Tier 3, the clustering of sites in Central Iowa with the SchoolNet 
network creates a large number of smaller polygons and doesn't help to eliminate
the larger polygons in Eastern Iowa.  The average polygon size on the maps are
only interesting in the fact that they indicate what the ideal size would be
if all of the sites were spread out equally. 

<h3><a name="represent">6. Coefficient of Representativity</a></h3>

<p>The Coefficient of Representativity (CR) was proposed by Dubois (2000) as a
measure to combine the Thiessen polygons and the distance to the nearest
neighbor.  The CR is a product of two terms, the first is a simple ratio of 
the area of the Thiessen polygon to the mean Thiessen polygon (total area 
divided by number of sampling points); the second is a ratio between the 
squared distance between nearest neighbors and the same mean Thiessen polygon.

<h4>Procedure:</h4>

<p>Thiessen polygons and network coverages were loaded into the IEM spatial
database.  Python scripts were then written to analyze distances and compute
other parameters needed for the CR.  
All spatial math was done in NAD83 UTM Zone15N.

<h4>Data:</h4>
<div class="figure">
<table>
<tr><td>Figure 7:<br/><img src="nni_images/tier1_cr.png"></td>
    <td>Figure 8:<br/><img src="nni_images/tier2_cr.png"></td></tr>
<tr><td>Figure 9:<br/><img src="nni_images/tier3_cr.png"></td>
    <td></td></tr>
</table>
</div>

<h4>Analysis:</h4>

<table cellspacing="0" cellpadding="3" border="1">
<caption>Table 6: CR Interruptation</caption>
<thead><tr><th>CR Value</th><th>Conclusion</th></tr></thead>
<tr><td>CR &gt; 1</td><td>The measure is isolated.</td></tr>
<tr><td>CR ~~ 1</td><td>Ideal case, measure is spatially uniform.</td></tr>
<tr><td>CR &lt; 1</td><td>The measure is clustered</td></tr>
</table>

<p>Tier 1 clearly shows the undersampled portions of the state, which are 
NE Iowa and parts of SW Iowa.  Adding the RWIS network in tier 2 increases
localized clustering at the expense of other areas where observations become
even more sparse.  Tier 3 clearly shows the affect of adding 60+ SchoolNet sites in Central Iowa, since the clustering goes up and the sparse areas get even worse due to the increased number of stations.

<h3><a name="conclusions">7. Conclusions</a></h3>

<p>To evaluate the spatial representativity of the Iowa Environmental Mesonet
(IEM),
five spatial statistics were computed following the work done by Dubois (2000).
While each statistic showed some positive aspects of the Mesonet collaboration,
they clearly point out the need for caution before blindly combining all 
available data into a high resolution product.

<p>The CR figures most clearly illustrate the difficulties of adding stations
from other networks and their localized impact on the overall analysis. Most of 
Northeast and a portion of Southcentral Iowa are clearly undersampled as 
shown by Figure 7 for Tier 1.  The easy solution would be to add stations
in those areas to 'fill in the holes'.  Up until this study, 
the IEM has focused on adding other networks to fill in these holes without 
realizing the implications of additional clustering in areas like Central and 
Eastern Iowa.  This "catch-22" can clearly be seen in Figure 8 for Tier 2 when
the RWIS sites, which are often located near the same towns as ASOS/AWOS sites, 
are added.  The addition of nearly 70 SchoolNet sites in Central Iowa only 
futher exasberbates the situation with undersampled areas showing up over the
rest of the state as shown in Figure 9.

<p>Clearly, this study points out the need for a disciplined approach before
adding networks in an ad-hoc manner to produce an analysis.  Perhaps 
non-standard networks included in Tier 2 and Tier 3 can be subsampled to 
selectively augment undersampled areas as shown in Figure 7.  There will 
always be trade offs when working with combining network and data.  It is 
important that one of these trade offs is not degredation in data quality.

<h3>References</h3>

<p>Dubois G (2000) How representative are samples in a sampling network? <i>J Geographic Info Decision Anal</i> 4:1-10


<h3>Links</h3>

<ul>
<li><a href="http://www.eumetnet.eu.org/Textes/WktZurich.htm">Workshop on Methods and Tools for the design of Surface observation networks</a>
<br />SWS - 2002 held in Zurich, 14-15 May 2002</li>

</div>

<?php include("$rootpath/include/footer.php"); ?>
