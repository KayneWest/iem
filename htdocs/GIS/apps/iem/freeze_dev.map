# Defaults 
NAME iem
STATUS ON
SIZE 640 480
FONTSET "/mesonet/data/gis/fonts/fonts.list"
#  Iowa, yeah!
# 3x2  
EXTENT -105 36 -86 50
UNITS DD
SHAPEPATH "/mesonet/data/gis/"
SYMBOLSET "/mesonet/data/gis/symbols/stations.sym"
IMAGECOLOR 0 0 0
IMAGETYPE PNG
TRANSPARENT off
INTERLACE off

PROJECTION
  "init=epsg:4326"
END

###-----------------------
# Web section
#-----------------------
WEB
  MINSCALE 90000
  MAXSCALE 40000000
  IMAGEPATH "/home/httpd/html/tmp/"
  IMAGEURL "/tmp/"
  LOG "/home/httpd/html/tmp/fancy.log"
  TEMPLATE test.html
END



LAYER
  NAME states
  STATUS DEFAULT
  TYPE LINE
  DATA /mesonet/data/gis/shape/unproj/us/states.shp
  PROJECTION
   "init=epsg:4326"
  END
  CLASS
    SYMBOL 'circle'
    SIZE 2
#    OUTLINECOLOR 0 255 0
#    COLOR 140 144 90
    COLOR  250 250 250
  END
END

LAYER
  NAME n0r
  STATUS DEFAULT
  TYPE RASTER
  DATA /mesonet/data/gis/images/unproj/MWCOMP/n0r_0.tif
  PROJECTION
   "init=epsg:4326"
  END
  OFFSITE 0 0 0
#  TRANSPARENCY 50
END

LAYER
  NAME credits
  TYPE ANNOTATION
  STATUS default
  TRANSFORM FALSE
  CLASS
    NAME 'credits'
    LABEL
      COLOR 0 0 0
      BACKGROUNDCOLOR 250 250 250
#      SHADOWSIZE 1 1
#      SHADOWCOLOR 0 0 0
#      BACKGROUNDSHADOWCOLOR 0 0 0
#      BACKGROUNDSHADOWSIZE 1 1
      TYPE TRUETYPE
      SIZE 16
      FONT 'kcci'
      POSITION CR
      FORCE TRUE
      PARTIALS TRUE
      BUFFER 2
    END
  END
END

 


LAYER
  NAME counties
  STATUS ON
  TYPE POLYGON
  DATA /mesonet/data/gis/shape/unproj/iem/iemcounties.shp
  PROJECTION
    "init=epsg:4326"
  END
  LABELCACHE OFF
  LABELITEM 'COUNTYNAME'
  MAXSCALE 5000000
  CLASS
    OUTLINECOLOR 186 116 13
#    COLOR 140 144 90
#    LABEL
#      SIZE TINY
#      TYPE BITMAP
#      POSITION LC
#      COLOR 190 190 190
#      OUTLINECOLOR 0 0 0
#      PARTIALS FALSE
#      FORCE FALSE
#    END
  END
#  TRANSPARENCY 75
END



LAYER
  CONNECTIONTYPE postgis
  NAME surface
  # Connect to a remote spatial database
  CONNECTION "user=nobody dbname=iem port=9999 host=10.10.10.30"
  # Get the lines from the 'geom' column of the 'roads' table
  DATA "geom from (select geom, round(tsf0::numeric,0) as tsf0,
    oid from current WHERE (valid > CURRENT_TIMESTAMP - '2 hours'::interval)
    and tsf0 > -30) as foo using unique oid using srid=4326"
  STATUS DEFAULT
  TYPE POINT
  LABELCACHE OFF
  PROJECTION
   "init=epsg:4326"
  END
  CLASSITEM "tsf0"
  CLASS
    EXPRESSION ([tsf0] >= 35)
    COLOR 30 137 20
    SYMBOL 'circle'
    SIZE 10
  END
  CLASS
    EXPRESSION ([tsf0] >= 34)
    COLOR 250 250 250
    SYMBOL 'circle'
    SIZE 10
    OVERLAYCOLOR 42 193 29
    OVERLAYSYMBOL 'circle'
    OVERLAYSIZE 8
  END
  CLASS
    EXPRESSION ([tsf0] >= 33)
    COLOR 250 250 250
    SYMBOL 'circle'
    SIZE 10
    OVERLAYCOLOR 53 224 37
    OVERLAYSYMBOL 'circle'
    OVERLAYSIZE 8
  END
  CLASS
    EXPRESSION ([tsf0] >= 32)
    COLOR 250 250 250
    SYMBOL 'circle'
    SIZE 10
    OVERLAYCOLOR 232 64 226
    OVERLAYSYMBOL 'circle'
    OVERLAYSIZE 8
  END
  CLASS
    EXPRESSION ([tsf0] >= 31)
    COLOR 250 250 250
    SYMBOL 'circle'
    SIZE 10
    OVERLAYCOLOR 232 114 226
    OVERLAYSYMBOL 'circle'
    OVERLAYSIZE 8
  END
  CLASS
    EXPRESSION ([tsf0] >= 30)
    COLOR 250 250 250
    SYMBOL 'circle'
    SIZE 10
    OVERLAYCOLOR 232 164 226
    OVERLAYSYMBOL 'circle'
    OVERLAYSIZE 8
  END
  CLASS
    EXPRESSION ([tsf0] < 30)
    COLOR 232 214 226
    SYMBOL 'circle'
    SIZE 10
  END
END

LAYER
  CONNECTIONTYPE postgis
  NAME sites
  # Connect to a remote spatial database
  CONNECTION "user=nobody dbname=iem port=9999 host=10.10.10.30"
  # Get the lines from the 'geom' column of the 'roads' table
  DATA "geom from (select geom, round(tmpf::numeric,0) as tmpf, 
    oid from current WHERE (valid > CURRENT_TIMESTAMP - '2 hours'::interval)
    ) as foo using unique oid using srid=4326"
  STATUS DEFAULT
  TYPE POINT
  LABELCACHE ON
  PROJECTION
   "init=epsg:4326"
  END
  CLASSITEM "tmpf"
  CLASS
    EXPRESSION ([tmpf] >= 35 && [tmpf] < 120)
    TEXT ([ tmpf ])
    COLOR -1 -1 -1
    LABEL
      COLOR 30 137 20
      #OUTLINECOLOR 250 250 250
      TYPE BITMAP
      SIZE MEDIUM
      POSITION UL
      OFFSET 2 2
      BUFFER 1
      PARTIALS TRUE
      FORCE FALSE
    END
  END
  CLASS
    EXPRESSION ([tmpf] >= 34)
    TEXT ([ tmpf ])
    COLOR -1 -1 -1
    LABEL
      COLOR 42 193 29
      #OUTLINECOLOR 250 250 250
      TYPE BITMAP
      SIZE MEDIUM
      POSITION UL
      OFFSET 2 2
      BUFFER 1
      PARTIALS TRUE
      FORCE FALSE
    END
  END
  CLASS
    EXPRESSION ([tmpf] >= 33)
    TEXT ([ tmpf ])
    COLOR -1 -1 -1
    LABEL
      COLOR 53 224 37
      #OUTLINECOLOR 250 250 250
      TYPE BITMAP
      SIZE MEDIUM
      POSITION UL
      OFFSET 2 2
      BUFFER 1
      PARTIALS TRUE
      FORCE FALSE
    END
  END
  CLASS
    EXPRESSION ([tmpf] >= 32)
    TEXT ([ tmpf ])
    COLOR -1 -1 -1
    LABEL
      COLOR 232 64 226
      TYPE BITMAP
      SIZE MEDIUM
      POSITION UL
      OFFSET 2 2
      BUFFER 1
      PARTIALS TRUE
      FORCE FALSE
    END
  END
  CLASS
    EXPRESSION ([tmpf] >= 31)
    TEXT ([ tmpf ])
    COLOR -1 -1 -1
    LABEL
      COLOR 232 114 226
      TYPE BITMAP
      SIZE MEDIUM
      POSITION UL
      OFFSET 2 2
      BUFFER 1
      PARTIALS TRUE
      FORCE FALSE
    END
  END
  CLASS
    EXPRESSION ([tmpf] >= 30)
    TEXT ([ tmpf ])
    COLOR -1 -1 -1
    LABEL
      COLOR 232 164 226
      TYPE BITMAP
      SIZE MEDIUM
      POSITION UL
      OFFSET 2 2
      BUFFER 1
      PARTIALS TRUE
      FORCE FALSE
    END
  END
  CLASS
    EXPRESSION ([tmpf] > -40)
    TEXT ([ tmpf ])
    COLOR -1 -1 -1
    LABEL
      COLOR 232 214 226
      TYPE BITMAP
      SIZE MEDIUM
      POSITION UL
      OFFSET 2 2
      BUFFER 1
      PARTIALS TRUE
      FORCE FALSE
    END
  END
END

LAYER
  CONNECTIONTYPE postgis
  NAME warnings0_c
  CONNECTION "user=akrherz dbname=postgis host=10.10.10.40"
  DATA "geom from (select type as wtype, geom, oid from warnings WHERE gtype = 'C' and expire > CURRENT_TIMESTAMP ORDER by expire, type ASC) as foo"
  STATUS ON
  TYPE POLYGON
  TEMPLATE q_template.html
  PROJECTION
   "init=epsg:4326"
  END
  CLASSITEM "wtype"
  CLASS
    EXPRESSION 'TOR'
    COLOR -1 -1 -1
    OUTLINECOLOR 255 0 0
    SIZE 2
    SYMBOL 1
  END
  CLASS
    EXPRESSION 'SVR'
    COLOR -1 -1 -1
    OUTLINECOLOR 255 255 0
    SIZE 2
    SYMBOL 1
  END
  CLASS
    EXPRESSION 'FFW'
    COLOR -1 -1 -1
    OUTLINECOLOR 0 255 0
    SIZE 2
    SYMBOL 1
  END
END


LAYER
 CONNECTIONTYPE postgis
 NAME watches
  CONNECTION "user=akrherz dbname=postgis host=10.10.10.40"
 DATA "geom from watches"
 PROJECTION
  "proj=latlong"
 END
 TYPE LINE
 STATUS DEFAULT
 FILTER "expired > CURRENT_TIMESTAMP"
 CLASSITEM 'type'
  CLASS
    EXPRESSION /SVR/
    COLOR 255 255 0
    SIZE 2
    SYMBOL 1
  END
  CLASS
    EXPRESSION /TOR/
    COLOR 255 0 0
    SIZE 2
    SYMBOL 1
  END
END


LAYER
  NAME logo
  #TYPE POINT
  TYPE ANNOTATION
  STATUS default
  TRANSFORM FALSE
  #TRANSPARENCY 10
  LABELCACHE OFF
  FEATURE
    POINTS 100 100 END
  END

  #CLASS
  #  SYMBOL 'iem_logo'
  #  SIZE 40
    #COLOR 0 0 0
  #END
   CLASS
     NAME "0"
     STYLE
       SYMBOL 'iem_logo'
       #COLOR 0 0 0
     END
     SIZE 40
     TEXT "."
     LABEL
       COLOR 0 0 0
     END
   END

END

END
